From 09d589ee81158d09589ebdcf85b2bf38745f957b Mon Sep 17 00:00:00 2001
From: Matthias Klumpp <matthias@tenstral.net>
Date: Wed, 31 Aug 2016 21:51:54 +0200
Subject: [PATCH] yaml: Set screenshot image type correctly

---
 src/as-yamldata.c   | 7 ++++---
 tools/ascli-utils.c | 2 +-
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/src/as-yamldata.c b/src/as-yamldata.c
index aea7347..4aefca6 100644
--- a/src/as-yamldata.c
+++ b/src/as-yamldata.c
@@ -598,13 +598,14 @@ as_yaml_process_provides (GNode *node, AsComponent *cpt)
  * as_yamldata_process_image:
  */
 static void
-as_yamldata_process_image (AsYAMLData *ydt, GNode *node, AsScreenshot *scr)
+as_yamldata_process_image (AsYAMLData *ydt, GNode *node, AsScreenshot *scr, AsImageKind ikind)
 {
 	GNode *n;
 	AsImage *img;
 	AsYAMLDataPrivate *priv = GET_PRIVATE (ydt);
 
 	img = as_image_new ();
+	as_image_set_kind (img, ikind);
 
 	for (n = node->children; n != NULL; n = n->next) {
 		const gchar *key;
@@ -680,11 +681,11 @@ as_yamldata_process_screenshots (AsYAMLData *ydt, GNode *node, AsComponent *cpt)
 				as_screenshot_set_caption (scr, lvalue, NULL);
 			} else if (g_strcmp0 (key, "source-image") == 0) {
 				/* there can only be one source image */
-				as_yamldata_process_image (ydt, n, scr);
+				as_yamldata_process_image (ydt, n, scr, AS_IMAGE_KIND_SOURCE);
 			} else if (g_strcmp0 (key, "thumbnails") == 0) {
 				/* the thumbnails are a list of images */
 				for (in = n->children; in != NULL; in = in->next) {
-					as_yamldata_process_image (ydt, in, scr);
+					as_yamldata_process_image (ydt, in, scr, AS_IMAGE_KIND_THUMBNAIL);
 				}
 			} else {
 				as_yaml_print_unknown ("screenshot", key);
diff --git a/tools/ascli-utils.c b/tools/ascli-utils.c
index eb63a77..493856d 100644
--- a/tools/ascli-utils.c
+++ b/tools/ascli-utils.c
@@ -329,7 +329,7 @@ ascli_print_component (AsComponent *cpt, gboolean show_detailed)
 			for (j = 0; j < imgs->len; j++) {
 				img = (AsImage*) g_ptr_array_index (imgs, j);
 				if (as_image_get_kind (img) == AS_IMAGE_KIND_SOURCE) {
-					ascli_print_key_value (_("Sample Screenshot URL"), as_image_get_url (img), FALSE);
+					ascli_print_key_value (_("Default Screenshot URL"), as_image_get_url (img), FALSE);
 					break;
 				}
 			}
