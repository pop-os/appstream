From d66c3b097d3a47bc403904b88104eadeb61f31fe Mon Sep 17 00:00:00 2001
From: Matthias Klumpp <matthias@tenstral.net>
Date: Sat, 22 Dec 2018 18:28:11 +0100
Subject: [PATCH] Don't warn about issues in a cache refresh if there weren't
 any

C really does set nice traps occasionally.
---
 src/as-pool.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/as-pool.c b/src/as-pool.c
index 2bb6bc1b..5e685d2e 100644
--- a/src/as-pool.c
+++ b/src/as-pool.c
@@ -506,7 +506,7 @@ as_pool_update_addon_info (AsPool *pool, AsComponent *cpt)
  *
  * Automatically refine the data we have about software components in the pool.
  *
- * Returns: %TRUE if all metadata was used, %FALSE if we skipped some stuff.
+ * Returns: Amount of invalid components.
  */
 static guint
 as_pool_refine_data (AsPool *pool)
@@ -1595,7 +1595,7 @@ as_pool_refresh_cache (AsPool *pool, gboolean force, GError **error)
 
 	/* load AppStream collection metadata only and refine it */
 	ret = as_pool_load_collection_data (pool, TRUE, &data_load_error);
-	ret_poolupdate = as_pool_refine_data (pool) && ret;
+	ret_poolupdate = (as_pool_refine_data (pool) == 0) && ret;
 	if (data_load_error != NULL)
 		g_debug ("Error while updating the in-memory data pool: %s", data_load_error->message);
 
